<root main_tree_to_execute="MainTree">
  <BehaviorTree ID="MainTree">
    <Sequence>
      <ControllerService service_name="/auv4/controller" enable="true"/>
        <!-- <DetectorAUVService service_name="/auv4/vision/detector" objects="badge,tommy_gun"/> -->

      <SetBlackboard output_key="pose_topic_name" value="/auv4/nav/odom_ned"/>>
      
      <!-- 10 Second delay -->
      <!-- <RetryUntilSuccesful num_attempts="-1">
        <IsTimeExpired seconds="10"/>
      </RetryUntilSuccesful> -->

      <!-- Hopefully it finds the object... -->
      <RetryUntilSuccesful num_attempts="-1">
        <UpdateDetectedObjects topic_name="/auv4/vision/detected" result="vision_detected" />
      </RetryUntilSuccesful>

      <FindBuoy vision_objects="{vision_detected}" target_identity="badge" forward="{forward}" sideways="{sideways}" depth="{depth}" yaw="{yaw}"/>
      
      <ReactiveSequence>
        <!-- Move Sideways-->
        <NavigateControl server_name="/auv4/LocomotionServer" forward="0.0" sideways="{sideways}" depth="0.7" yaw="0"/>

        <!-- Move Forward -->
        <NavigateControl server_name="/auv4/LocomotionServer" forward="{forward}" sideways="0.0" depth="0.7" yaw="0"/>
      </ReactiveSequence>
      
      <ControllerService service_name="/auv4/controller" enable="false" />  
    </Sequence>
  </BehaviorTree>
</root>
